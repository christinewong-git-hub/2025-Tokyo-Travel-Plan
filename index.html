<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Seoul Trip Planner âœˆï¸</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Vue.js 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Remix Icons -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Google Maps APIï¼šå·²æ›¿æ›ç‚ºä½ çš„ API Key -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDjwdhovqjl-ttXg7UzIYD7x-gFPdCuu4Q&callback=initMap&libraries=geometry"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#97CBFF',
                        secondary: '#C7C7E2',
                        bgLight: '#ECF5FF',
                        white: '#FFFFFF',
                        textMain: '#4A5568',
                        textLight: '#A0AEC0'
                    },
                    fontFamily: {
                        sans: ['"Noto Sans TC"', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #f0f4f8; font-family: 'Noto Sans TC', sans-serif; }
        .app-container {
            max-width: 480px;
            margin: 0 auto;
            min-height: 100vh;
            background: linear-gradient(135deg, #ECF5FF 0%, #D4E8FF 100%);
        }
        ::-webkit-scrollbar { display: none; }
        .card-shadow { box-shadow: 0 8px 25px rgba(151, 203, 255, 0.15); }
        .glass-effect { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(20px); }
        .timeline-line {
            position: absolute;
            left: 24px;
            top: 50px;
            bottom: -20px;
            width: 3px;
            background: linear-gradient(to bottom, #97CBFF, #C7C7E2);
            z-index: 0;
        }
        #map { height: 350px !important; border-radius: 20px; }
        .route-info { background: linear-gradient(135deg, #97CBFF, #A3D0FF); }
    </style>
</head>
<body>

<div id="app" class="app-container p-4 pb-20">
    
    <!-- Header -->
    <header class="glass-effect rounded-3xl p-6 mb-6 card-shadow border border-white/50">
        <div class="flex justify-between items-center mb-4">
            <div>
                <h1 class="text-2xl font-bold bg-gradient-to-r from-primary to-blue-400 bg-clip-text text-transparent">é¦–çˆ¾æ—…è¡Œæ—¥è¨˜</h1>
            <p class="text-sm text-textLight">12/24 - 01/01 â€¢ â„ï¸å†¬æ—¥é™å®š</p>
            </div>
            <div class="w-12 h-12 bg-primary/20 rounded-2xl flex items-center justify-center backdrop-blur-sm">
                <i class="ri-heart-fill text-xl text-primary"></i>
            </div>
        </div>
    </header>

    <!-- Tabs Navigation -->
    <div class="flex bg-white/80 backdrop-blur-md rounded-2xl p-1 mb-6 card-shadow border border-white/50">
        <button v-for="tab in tabs" :key="tab.id" @click="currentTab = tab.id"
                :class="currentTab === tab.id ? 'bg-primary text-white shadow-md' : 'text-textLight hover:text-textMain'"
                class="flex-1 py-3 px-4 rounded-xl text-sm font-bold transition-all">
            <i :class="tab.icon" class="text-lg mb-1 block"></i>
            {{ tab.name }}
        </button>
    </div>

    <!-- è¡Œç¨‹è¡¨ -->
    <div v-if="currentTab === 'schedule'" class="space-y-6">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-textMain">ğŸ“… Day 1 è¡Œç¨‹è¦åŠƒ</h2>
            <button @click="addItineraryItem" class="bg-primary text-white px-6 py-2 rounded-2xl font-bold shadow-lg hover:scale-105 transition">
                + æ–°å¢
            </button>
        </div>

        <!-- Timeline -->
        <div class="relative space-y-6">
            <div v-for="(item, index) in itinerary" :key="index" class="timeline-item pl-16 relative group">
                <div class="timeline-line"></div>
                
                <!-- Time Bubble -->
                <div class="absolute left-0 top-2 w-14 h-14 bg-white/80 backdrop-blur rounded-3xl border-4 border-primary flex flex-col items-center justify-center shadow-xl z-20">
                    <span class="text-sm font-bold text-primary">{{ item.time.split(':')[0] }}</span>
                    <span class="text-xs text-textLight">{{ item.time.split(':')[1] }}</span>
                </div>

                <!-- Itinerary Card -->
                <div class="glass-effect p-6 rounded-3xl card-shadow border border-white/30 hover:shadow-2xl transition-all group-hover:scale-[1.02]">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex-1 pr-4">
                            <h3 class="font-bold text-xl text-textMain mb-2 leading-tight">{{ item.activity }}</h3>
                            <div class="flex items-center gap-2 text-sm text-textLight mb-3">
                                <i class="ri-map-pin-2-fill text-primary"></i>
                                {{ item.location }}
                            </div>
                            <div v-if="item.distance" class="text-xs bg-primary/20 text-primary px-3 py-1 rounded-full font-medium">
                                è·é›¢ {{ item.distance }} â€¢ {{ item.duration }}
                            </div>
                        </div>
                        <button @click="removeItineraryItem(index)" class="text-red-300 hover:text-red-500 p-2 -m-2 rounded-xl hover:bg-red-50 transition">
                            <i class="ri-close-circle-line text-xl"></i>
                        </button>
                    </div>
                    
                    <!-- Navigation Buttons -->
                    <div class="flex gap-2 pt-3">
                        <a :href="getSingleDirectionLink(index)" target="_blank" 
                           class="flex-1 bg-primary/90 text-white py-3 px-4 rounded-2xl text-sm font-bold text-center hover:bg-primary transition shadow-lg">
                            <i class="ri-route-line inline-block mr-1"></i>å–®ç¨‹å°èˆª
                        </a>
                        <button @click="showFullRoute" 
                                class="bg-secondary text-white py-3 px-4 rounded-2xl text-sm font-bold hover:bg-opacity-90 transition shadow-lg">
                            <i class="ri-car-line inline-block mr-1"></i>å®Œæ•´è·¯ç·š
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Route Summary -->
        <div v-if="routeSummary" class="glass-effect p-6 rounded-3xl card-shadow border border-white/30 mt-8">
            <h3 class="font-bold text-lg text-textMain mb-3 flex items-center gap-2">
                <i class="ri-route-fill text-primary"></i>å®Œæ•´è·¯ç·šç¸½è¦½
            </h3>
            <div class="grid grid-cols-3 gap-4 text-center">
                <div>
                    <div class="text-2xl font-bold text-primary">{{ routeSummary.distance }}</div>
                    <div class="text-xs text-textLight">ç¸½è·é›¢</div>
                </div>
                <div>
                    <div class="text-2xl font-bold text-primary">{{ routeSummary.duration }}</div>
                    <div class="text-xs text-textLight">ç¸½æ™‚é–“</div>
                </div>
                <div>
                    <div class="text-2xl font-bold text-primary">{{ itinerary.length }}ç«™</div>
                    <div class="text-xs text-textLight">åœé é»</div>
                </div>
            </div>
        </div>
    </div>

    <!-- åœ°åœ–é ç±¤ (å®Œæ•´è·¯ç·šåœ°åœ–) -->
    <div v-if="currentTab === 'map'" class="space-y-4">
        <div class="flex items-center gap-3 mb-4">
            <button @click="currentTab = 'schedule'" class="text-primary">
                <i class="ri-arrow-left-line text-2xl"></i>
            </button>
            <h2 class="flex-1 text-xl font-bold text-textMain text-center">ğŸ—ºï¸ å®Œæ•´è·¯ç·šåœ°åœ–</h2>
        </div>
        
        <!-- Google Maps Container -->
        <div id="map" class="w-full rounded-3xl card-shadow"></div>
        
        <div class="glass-effect p-4 rounded-3xl card-shadow border border-white/30">
            <div class="flex justify-between items-center mb-3">
                <span class="font-bold text-textMain">è·¯ç·šé¸é …</span>
                <select v-model="travelMode" @change="updateRoute" class="bg-white px-3 py-2 rounded-xl text-sm shadow-sm">
                    <option value="DRIVING">ğŸš— é–‹è»Š</option>
                    <option value="WALKING">ğŸš¶ æ­¥è¡Œ</option>
                    <option value="BICYCLING">ğŸš² å–®è»Š</option>
                    <option value="TRANSIT">ğŸš‡ å¤§çœ¾é‹è¼¸</option>
                </select>
            </div>
            <button @click="updateRoute" class="w-full bg-primary text-white font-bold py-4 rounded-2xl shadow-lg hover:shadow-xl transition">
                ğŸ”„ é‡æ–°è¨ˆç®—è·¯ç·š
            </button>
        </div>
    </div>

    <!-- å…¶ä»–é ç±¤ Placeholderï¼šä¹‹å¾Œå¯å¡å›ä½ åŸæœ¬çš„è¨˜å¸³èˆ‡è³¼ç‰©å…§å®¹ -->
    <div v-if="currentTab === 'budget'" class="space-y-6">
        <h2 class="text-2xl font-bold text-textMain">ğŸ’° æ™ºæ…§è¨˜å¸³</h2>
        <p class="text-textLight text-sm">é€™è£¡å¯ä»¥æ”¾ä½ ä¹‹å‰åšå¥½çš„è¨˜å¸³ï¼‹åŒ¯ç‡åŠŸèƒ½å€å¡Šã€‚</p>
    </div>

    <div v-if="currentTab === 'shopping'" class="space-y-6">
        <h2 class="text-2xl font-bold text-textMain">ğŸ›ï¸ è³¼ç‰©æ¸…å–®</h2>
        <p class="text-textLight text-sm">é€™è£¡å¯ä»¥æ”¾ä½ çš„è³¼ç‰©æ¸…å–®å¡ç‰‡è¨­è¨ˆã€‚</p>
    </div>
</div>

<script>
let map, directionsService, directionsDisplay;
let app;

function initMap() {
    map = new google.maps.Map(document.getElementById('map'), {
        zoom: 12,
        center: { lat: 37.5665, lng: 126.9780 },
        mapTypeControl: false,
        fullscreenControl: false,
        streetViewControl: false,
        styles: [
            { featureType: 'poi', elementType: 'labels', stylers: [{ visibility: 'off' }] }
        ]
    });
    
    directionsService = new google.maps.DirectionsService();
    directionsDisplay = new google.maps.DirectionsRenderer({
        map: map,
        suppressMarkers: false,
        polylineOptions: {
            strokeColor: '#97CBFF',
            strokeWeight: 6
        }
    });
}

const { createApp } = Vue;
app = createApp({
    data() {
        return {
            currentTab: 'schedule',
            tabs: [
                { id: 'schedule', name: 'è¡Œç¨‹', icon: 'ri-calendar-todo-fill' },
                { id: 'map', name: 'åœ°åœ–', icon: 'ri-map-2-fill' },
                { id: 'budget', name: 'è¨˜å¸³', icon: 'ri-wallet-3-fill' },
                { id: 'shopping', name: 'è³¼ç‰©', icon: 'ri-shopping-bag-3-fill' }
            ],
            travelMode: 'TRANSIT',
            
            itinerary: [
                { time: '09:00', activity: 'ä»å·æ©Ÿå ´æŠµé”', location: 'ä»å·åœ‹éš›æ©Ÿå ´, South Korea' },
                { time: '11:30', activity: 'å¼˜å¤§é…’åº— Check-in', location: 'RYSE, Autograph Collection, Hongdae, Seoul' },
                { time: '14:00', activity: 'å»¶å—æ´å’–å•¡å·¡ç¦®', location: 'Yeonnam-dong, Mapo-gu, Seoul' },
                { time: '18:00', activity: 'æ¼¢æ±Ÿå…¬åœ’è³å¤œæ™¯', location: 'Yeouido Hangang Park, Seoul' }
            ],
            routeSummary: null
        }
    },
    mounted() {
        if (typeof google !== 'undefined' && google.maps && document.getElementById('map')) {
            this.$nextTick(() => {
                initMap();
                this.updateRoute();
            });
        }
    },
    methods: {
        async updateRoute() {
            if (!directionsService || this.itinerary.length < 2) return;
            
            const waypoints = this.itinerary.slice(1, -1).map(item => ({
                location: item.location,
                stopover: true
            }));

            const request = {
                origin: this.itinerary[0].location,
                destination: this.itinerary[this.itinerary.length - 1].location,
                waypoints: waypoints,
                optimizeWaypoints: true,
                travelMode: google.maps.TravelMode[this.travelMode]
            };

            try {
                const result = await new Promise((resolve, reject) => {
                    directionsService.route(request, (result, status) => {
                        if (status === 'OK') resolve(result);
                        else reject(status);
                    });
                });

                directionsDisplay.setDirections(result);
                
                const route = result.routes[0];
                const totalDistance = route.legs.reduce((sum, leg) => sum + leg.distance.value, 0) / 1000;
                const totalDuration = route.legs.reduce((sum, leg) => sum + leg.duration.value, 0) / 60;
                
                this.routeSummary = {
                    distance: `${totalDistance.toFixed(1)}km`,
                    duration: `${Math.floor(totalDuration/60)}h ${Math.round(totalDuration%60)}m`,
                    legs: route.legs.length
                };

                this.itinerary.forEach((item, index) => {
                    if (index > 0 && route.legs[index-1]) {
                        item.distance = route.legs[index-1].distance.text;
                        item.duration = route.legs[index-1].duration.text;
                    }
                });

            } catch (error) {
                console.error('è·¯ç·šè¨ˆç®—å¤±æ•—:', error);
                alert('ç„¡æ³•è¨ˆç®—è·¯ç·šï¼Œè«‹æª¢æŸ¥åœ°é»åç¨±æˆ–ç¨å¾Œå†è©¦');
            }
        },

        getSingleDirectionLink(index) {
            if (index === 0) {
                return `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(this.itinerary[index].location)}`;
            }
            const prev = encodeURIComponent(this.itinerary[index-1].location);
            const curr = encodeURIComponent(this.itinerary[index].location);
            return `https://www.google.com/maps/dir/?api=1&origin=${prev}&destination=${curr}&travelmode=transit`;
        },

        showFullRoute() {
            this.currentTab = 'map';
            this.$nextTick(() => this.updateRoute());
        },

        addItineraryItem() {
            const time = prompt('æ™‚é–“ (HH:MM)');
            const activity = prompt('æ´»å‹•åç¨±');
            const location = prompt('è©³ç´°åœ°é» (è«‹åŒ…å«åŸå¸‚åç¨±ä»¥åˆ©å°èˆª)');
            if (time && activity) {
                this.itinerary.push({ time, activity, location: location || activity });
                this.itinerary.sort((a, b) => a.time.localeCompare(b.time));
                this.$nextTick(() => this.updateRoute());
            }
        },

        removeItineraryItem(index) {
            if (confirm('ç¢ºå®šåˆªé™¤æ­¤è¡Œç¨‹ï¼Ÿ')) {
                this.itinerary.splice(index, 1);
                this.$nextTick(() => this.updateRoute());
            }
        }
    }
}).mount('#app');
</script>
</body>
</html>
